---
import { t } from "@/i18n/translations";
import { getLocalizedHref } from "@/lib/utils/get-localized-href";
import ButtonLink from "../shared/button-link.astro";
import { Body } from "../shared/typography/body";

interface Props {
  variant: "button" | "underline";
}

const searchParams = Astro.url.searchParams;

function getClearUrl(): string {
  const newParams = new URLSearchParams(searchParams);
  newParams.delete("collection");
  newParams.delete("category");
  const queryString = newParams.toString();
  return queryString
    ? `?${queryString}`
    : getLocalizedHref({
        href: "/products",
        language: Astro.locals.language,
      });
}

const { variant } = Astro.props;
const language = Astro.locals.language;
---

{variant === "button" ? (
  <ButtonLink class="mt-3" href={getClearUrl()} size="sm" variant="outline">
    {t("filter.clearFilters", language)}
  </ButtonLink>
) : (
  <a href={getClearUrl()}>
    <Body className="underline" font="sans" mobileSize="sm">
      {t("filter.clearAll", language)}
    </Body>
  </a>
)}
